<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vocabulary Guess — Mini Game</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#0f172a; --bg2:#0b1220; --card:#101c38;
      --accent:#7c3aed; --accent2:#06b6d4; --glass: rgba(255,255,255,0.06);
      --success: #10b981; --danger: #ef4444; --warning: #f59e0b;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial; color:#e6eef8; 
      background: radial-gradient(800px 400px at 10% 10%, rgba(124,58,237,0.18), transparent), 
                  radial-gradient(600px 600px at 90% 90%, rgba(6,182,212,0.15), transparent),
                  linear-gradient(180deg,var(--bg1), var(--bg2));
      min-height:100vh; display:flex; align-items:center; justify-content:center; padding:32px;
      position: relative;
      overflow: hidden;
    }
    body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 20% 30%, rgba(124, 58, 237, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(6, 182, 212, 0.1) 0%, transparent 50%);
      z-index: -1;
    }
    .wrap{
      width:960px; max-width:95%; max-height: 95vh;
      background: linear-gradient(135deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%);
      border-radius:24px; padding:28px; 
      box-shadow: 0 16px 50px rgba(2,6,23,0.6), 
                  inset 0 1px 0 rgba(255,255,255,0.05);
      border:1px solid rgba(255,255,255,0.03);
      backdrop-filter: blur(10px);
      position: relative;
      z-index: 1;
      overflow-y: auto;
    }
    .wrap::-webkit-scrollbar {
      width: 0;
      background: transparent;
    }
    .wrap::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      z-index: 2;
    }
    header{
      display:flex; 
      gap:16px; 
      align-items:center;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      margin-bottom: 20px;
    }
    .logo{
      width:76px;height:76px;border-radius:18px;
      background:linear-gradient(135deg,var(--accent),var(--accent2)); 
      display:flex;align-items:center;justify-content:center;
      font-weight:800;font-size:20px;color:white;
      box-shadow:0 8px 30px rgba(124,58,237,0.18);
      position: relative;
      overflow: hidden;
    }
    .logo::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 50%);
    }
    h1{
      margin:0;
      font-size:22px;
      background: linear-gradient(90deg, #fff, rgba(255,255,255,0.8));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    p.lead{
      margin:0;
      color:rgba(230,238,248,0.75);
      font-size: 14px;
    }

    .game{
      display:grid;
      grid-template-columns:1fr 320px;
      gap:20px;
      margin-top:18px;
    }
    .card{
      background:var(--card); 
      border-radius:18px; 
      padding:20px; 
      border:1px solid rgba(255,255,255,0.04);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.15);
    }

    .question{
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .q-top{
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .word{
      font-size:46px;
      font-weight:800;
      letter-spacing:0.6px;
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      -webkit-background-clip:text;
      background-clip: text;
      color:transparent;
      text-shadow: 0 2px 10px rgba(124, 58, 237, 0.3);
      position: relative;
      display: inline-block;
    }
    .word::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      opacity: 0.5;
      border-radius: 2px;
    }
    .meta{
      font-size:13px;
      color:rgba(230,238,248,0.6);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .options{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:14px;
      margin-top:6px;
    }
    .opt{
      padding:14px;
      border-radius:12px;
      background:var(--glass);
      cursor:pointer;
      border:1px solid rgba(255,255,255,0.05);
      transition:all .18s; 
      user-select:none;
      backdrop-filter:blur(6px);
      position: relative;
      overflow: hidden;
    }
    .opt::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, transparent 50%);
      opacity: 0;
      transition: opacity 0.2s;
    }
    .opt:hover{
      transform:translateY(-4px) scale(1.02);
      box-shadow:0 10px 22px rgba(0,0,0,0.45);
      border-color: rgba(255,255,255,0.1);
    }
    .opt:hover::before {
      opacity: 1;
    }
    .opt.correct{
      background:linear-gradient(90deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.05));
      border-color: rgba(16, 185, 129, 0.4);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
    }
    .opt.wrong{
      background:linear-gradient(90deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.05));
      border-color: rgba(239, 68, 68, 0.4);
      box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);
    }

    .side{
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .stats{
      display:flex;
      gap:10px;
      align-items:center;
    }
    .stat{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); 
      padding:12px;
      border-radius:12px;
      flex:1;
      text-align:center;
      position: relative;
      overflow: hidden;
    }
    .stat::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255,255,255,0.02) 0%, transparent 50%);
    }
    .big{
      font-size:22px;
      font-weight:700;
    }
    .score-value {
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .controls{
      display:flex;
      gap:8px;
      margin-top:12px;
    }
    button{
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      border:0;
      padding:10px 14px;
      border-radius:12px;
      color:white;
      font-weight:700;
      cursor:pointer;
      transition:all .2s;
      position: relative;
      overflow: hidden;
    }
    button::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, rgba(255,255,255,0.1) 0%, transparent 50%);
      opacity: 0;
      transition: opacity 0.2s;
    }
    button:hover{
      opacity:0.9;
      transform:scale(1.03);
      box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
    }
    button:hover::before {
      opacity: 1;
    }
    button.ghost{
      background:transparent;
      border:1px solid rgba(255,255,255,0.06);
    }
    button.ghost:hover {
      background: rgba(255,255,255,0.05);
      border-color: rgba(255,255,255,0.1);
    }

    .progress{
      height:10px;
      background:rgba(255,255,255,0.05);
      border-radius:999px;
      overflow:hidden;
      position: relative;
    }
    .progress > i{
      display:block;
      height:100%;
      background:linear-gradient(90deg,#7c3aed,#06b6d4);
      width:0%;
      border-radius: 999px;
      transition: width 0.5s ease;
      position: relative;
      overflow: hidden;
    }
    .progress > i::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, rgba(255,255,255,0.2) 0%, transparent 50%);
    }

    .timer-container {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 8px;
    }
    .timer-circle {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: conic-gradient(var(--accent) 0%, rgba(255,255,255,0.1) 0%);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    .timer-circle::before {
      content: '';
      position: absolute;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--card);
    }
    .timer-value {
      position: relative;
      z-index: 1;
      font-size: 12px;
      font-weight: 700;
    }

    .footer{display:none}

    /* Confetti for celebration */
    .confetti{position:fixed;left:0;right:0;top:0;pointer-events:none;height:0; z-index: 1000;}
    .confetti > span{position:absolute;width:10px;height:14px;opacity:0;transform:translateY(-20px);animation:fall 1600ms linear forwards}
    @keyframes fall{0%{opacity:1;transform:translateY(-10vh) rotate(0)}100%{opacity:1;transform:translateY(110vh) rotate(720deg)}}

    /* Particle effects */
    .particles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }
    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: rgba(255,255,255,0.3);
      border-radius: 50%;
      animation: float 15s infinite linear;
    }
    @keyframes float {
      0% {
        transform: translateY(100vh) translateX(0);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100px) translateX(20px);
        opacity: 0;
      }
    }

    /* Result modal */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(15, 23, 42, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
    }
    .modal.active {
      opacity: 1;
      visibility: visible;
    }
    .modal-content {
      background: linear-gradient(135deg, var(--card), rgba(16, 28, 56, 0.9));
      border-radius: 20px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.05);
      transform: translateY(20px);
      transition: transform 0.3s;
    }
    .modal.active .modal-content {
      transform: translateY(0);
    }
    .modal h2 {
      margin-top: 0;
      font-size: 24px;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .modal-stats {
      display: flex;
      justify-content: space-around;
      margin: 20px 0;
    }
    .modal-stat {
      text-align: center;
    }
    .modal-stat-value {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 5px;
    }
    .modal-stat-label {
      font-size: 14px;
      color: rgba(230,238,248,0.7);
    }

    @media (max-width:880px){
      .game{grid-template-columns:1fr;}
      .side{order:2}
      .options{grid-template-columns:1fr;}
    }
  </style>
</head>
<body>
  <div class="particles" id="particles"></div>
  
  <div class="wrap">
    <header>
      <div class="logo">VG</div>
      <div>
        <h1>Vocabulary Guess — Mini Game</h1>
        <p class="lead">Đoán nghĩa từ tiếng Anh (chọn đáp án đúng).</p>
      </div>
    </header>

    <div class="game">
      <div class="card">
        <div class="question">
          <div class="q-top">
            <div>
              <div class="meta">Từ vựng</div>
              <div class="word" id="word">—</div>
            </div>
            <div style="text-align:right">
              <div class="meta">Câu hỏi <span id="qnum">0</span>/<span id="total">0</span></div>
              <div class="timer-container">
                <div class="timer-circle" id="timerCircle">
                  <div class="timer-value" id="timer">--</div>
                </div>
                <div class="meta">giây</div>
              </div>
            </div>
          </div>

          <div class="options" id="options"></div>

          <div class="controls">
            <button id="nextBtn" class="ghost">Bỏ qua →</button>
            <button id="startBtn">Bắt đầu</button>
          </div>

        </div>
      </div>

      <aside class="side">
        <div class="card">
          <div class="meta">Tiến độ</div>
          <div class="progress" style="margin-top:8px"><i id="progressBar"></i></div>
          <div style="margin-top:10px;display:flex;gap:8px">
            <button id="shuffleBtn" class="ghost">Xáo trộn</button>
            <button id="showAnswer" class="ghost">Hiện đáp án</button>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <div class="modal" id="resultModal">
    <div class="modal-content">
      <h2>Hoàn thành!</h2>
      <div class="modal-stats">
        <div class="modal-stat">
          <div class="modal-stat-value score-value" id="modalScore">0</div>
          <div class="modal-stat-label">Điểm</div>
        </div>
        <div class="modal-stat">
          <div class="modal-stat-value score-value" id="modalStreak">0</div>
          <div class="modal-stat-label">Chuỗi cao nhất</div>
        </div>
      </div>
      <button id="playAgainBtn" style="margin-top: 20px;">Chơi lại</button>
    </div>
  </div>

  <div class="confetti" id="confetti"></div>

  <audio id="sound-correct" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg" preload="auto"></audio>
  <audio id="sound-wrong" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>

  <script>
    const vocab = [
      {en: 'aim', vn: 'mục tiêu'},
      {en: 'environment', vn: 'môi trường'},
      {en: 'set up', vn: 'thiết kế'},
      {en: 'adopt', vn: 'theo, chọn theo'},
      {en: 'lifestyle', vn: 'lối sống'},
      {en: 'ceremony', vn: 'buổi lễ'}
    ];

    let order = [];
    let idx = 0;
    let score = 0;
    let streak = 0;
    let maxStreak = 0;
    let timer = null;
    let timeLeft = 20;

    const wordEl = document.getElementById('word');
    const optionsEl = document.getElementById('options');
    const qnum = document.getElementById('qnum');
    const total = document.getElementById('total');
    const progressBar = document.getElementById('progressBar');
    const timerEl = document.getElementById('timer');
    const timerCircle = document.getElementById('timerCircle');
    const startBtn = document.getElementById('startBtn');
    const nextBtn = document.getElementById('nextBtn');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const showAnswerBtn = document.getElementById('showAnswer');
    const confetti = document.getElementById('confetti');
    const soundCorrect = document.getElementById('sound-correct');
    const soundWrong = document.getElementById('sound-wrong');
    const resultModal = document.getElementById('resultModal');
    const modalScore = document.getElementById('modalScore');
    const modalStreak = document.getElementById('modalStreak');
    const playAgainBtn = document.getElementById('playAgainBtn');
    const particlesContainer = document.getElementById('particles');

    function init(){
      order = vocab.map((_,i)=>i);
      total.textContent = order.length;
      updateUI();
      createParticles();
    }

    function createParticles() {
      for (let i = 0; i < 30; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 15 + 's';
        particle.style.width = Math.random() * 4 + 2 + 'px';
        particle.style.height = particle.style.width;
        particlesContainer.appendChild(particle);
      }
    }

    function shuffle(a){
      for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a;
    }

    function startGame(){
      shuffle(order);
      idx=0; score=0; streak=0; maxStreak = 0;
      startBtn.textContent='Đang chơi'; startBtn.disabled=true;
      nextBtn.disabled=false;
      resultModal.classList.remove('active');
      renderQuestion();
    }

    function renderQuestion(){
      clearTimer();
      if(idx>=order.length){
        finish(); return;
      }
      const item = vocab[order[idx]];
      wordEl.textContent = item.en;
      qnum.textContent = idx+1;
      const others = vocab.filter((_,i)=>i!==order[idx]).map(x=>x.vn);
      shuffle(others);
      const choices = [item.vn, others[0], others[1] || others[0], others[2] || others[0]];
      shuffle(choices);
      optionsEl.innerHTML='';
      choices.forEach(ch=>{
        const d = document.createElement('div'); d.className='opt'; d.textContent=ch;
        d.addEventListener('click',()=>selectAnswer(d, item.vn));
        optionsEl.appendChild(d);
      });
      updateProgress();
      startTimer();
    }

    function selectAnswer(el, correct){
      if(el.classList.contains('disabled')) return;
      disableOptions();
      clearTimer();
      const chosen = el.textContent;
      if(chosen === correct){
        el.classList.add('correct');
        soundCorrect.currentTime=0; soundCorrect.play();
        score += 10; streak += 1;
        if (streak > maxStreak) maxStreak = streak;
        celebrate();
      } else {
        el.classList.add('wrong');
        soundWrong.currentTime=0; soundWrong.play();
        Array.from(optionsEl.children).forEach(node=>{ if(node.textContent===correct) node.classList.add('correct') });
        streak = 0;
      }
      setTimeout(()=>{ idx++; renderQuestion(); }, 900);
    }

    function disableOptions(){ Array.from(optionsEl.children).forEach(n=>n.classList.add('disabled')) }

    function startTimer(){
      timeLeft = 20; 
      timerEl.textContent = timeLeft;
      updateTimerCircle();
      
      timer = setInterval(()=>{
        timeLeft--; 
        timerEl.textContent = timeLeft;
        updateTimerCircle();
        
        if(timeLeft<=0){ 
          clearInterval(timer); 
          timer=null; 
          handleTimeout(); 
        }
      },1000);
    }
    
    function updateTimerCircle() {
      const percentage = (timeLeft / 20) * 100;
      timerCircle.style.background = `conic-gradient(var(--accent) ${percentage}%, rgba(255,255,255,0.1) 0%)`;
    }
    
    function clearTimer(){ 
      if(timer){ 
        clearInterval(timer); 
        timer=null; 
      } 
    }

    function handleTimeout(){ 
      disableOptions();
      const correct = vocab[order[idx]].vn;
      Array.from(optionsEl.children).forEach(node=>{ if(node.textContent===correct) node.classList.add('correct') });
      streak=0;
      setTimeout(()=>{ idx++; renderQuestion(); },900);
    }

    function finish(){
      modalScore.textContent = score;
      modalStreak.textContent = maxStreak;
      resultModal.classList.add('active');
      startBtn.textContent='Chơi lại'; 
      startBtn.disabled=false; 
      startBtn.onclick = ()=>startGame();
      nextBtn.disabled=true; 
      clearTimer();
    }

    function updateProgress(){ 
      const p = Math.round((idx/order.length)*100); 
      progressBar.style.width = p+'%'; 
    }
    
    function updateUI(){ 
      total.textContent = order.length; 
      qnum.textContent = Math.min(idx+1, order.length); 
    }

    function celebrate(){
      for(let i=0;i<18;i++){
        const s = document.createElement('span');
        s.style.left = (10 + Math.random()*80) + '%';
        s.style.background = ['#ef4444','#f59e0b','#10b981','#3b82f6','#8b5cf6'][Math.floor(Math.random()*5)];
        s.style.top = '-10vh';
        s.style.transform = 'translateY(-20px) rotate('+Math.floor(Math.random()*360)+'deg)';
        s.style.animationDelay = (Math.random()*400)+'ms';
        confetti.appendChild(s);
        setTimeout(()=>s.remove(),1800);
      }
    }

    startBtn.addEventListener('click',()=>{ if(startBtn.disabled) return; startGame(); });
    nextBtn.addEventListener('click',()=>{ idx++; renderQuestion(); });
    shuffleBtn.addEventListener('click',()=>{ shuffle(order); idx=0; renderQuestion(); });
    showAnswerBtn.addEventListener('click',()=>{ 
      const correct = vocab[order[idx]]?.vn; 
      if(!correct) return; 
      Array.from(optionsEl.children).forEach(node=>{ 
        if(node.textContent===correct) node.classList.add('correct') 
      }); 
      clearTimer(); 
      setTimeout(()=>{ idx++; renderQuestion(); },900); 
    });
    
    playAgainBtn.addEventListener('click', () => {
      resultModal.classList.remove('active');
      startGame();
    });

    init();
  </script>
</body>
</html>